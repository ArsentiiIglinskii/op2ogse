#include "common.h"
#define EPS 0.0001f
float4 main(combine I):COLOR0
{
	float sceneDepth0 = normalize_depth(get_depth(I.tc0.xy + float2(0, 1.0) * ogse_c_resolution.zw)/*tex2D(s_position, I.tc0.xy + float2(0, 1.0) * ogse_c_resolution.zw).z*/);
	float sceneDepth1 = normalize_depth(get_depth(I.tc0.xy + float2(1, 0.65) * ogse_c_resolution.zw)/*tex2D(s_position, I.tc0.xy + float2(1, 0.65) * ogse_c_resolution.zw).z*/);
	float sceneDepth2 = normalize_depth(get_depth(I.tc0.xy + float2(-1, 0.65) * ogse_c_resolution.zw)/*tex2D(s_position, I.tc0.xy + float2(-1, 0.65) * ogse_c_resolution.zw).z*/);

	float sceneDepth = (saturate(sceneDepth0) + saturate(sceneDepth1) + saturate(sceneDepth2)) * 0.333;
	
	float depth = is_sky(sceneDepth);
	float4 Color = float4(depth, depth, depth, sceneDepth);
	
	return Color;
}